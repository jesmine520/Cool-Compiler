#name "stack.cl"
#15 CLASS
#15 TYPEID StackNode
#15 INHERITS
#15 TYPEID Object
#15 '{'
#16 OBJECTID item
#16 ':'
#16 TYPEID Object
#16 ';'
#17 OBJECTID next
#17 ':'
#17 TYPEID StackNode
#17 ';'
#20 OBJECTID init
#20 '('
#20 OBJECTID i
#20 ':'
#20 TYPEID Object
#20 ','
#20 OBJECTID n
#20 ':'
#20 TYPEID StackNode
#20 ')'
#20 ':'
#20 TYPEID StackNode
#20 '{'
#21 '{'
#22 OBJECTID item
#22 ASSIGN
#22 OBJECTID i
#22 ';'
#23 OBJECTID next
#23 ASSIGN
#23 OBJECTID n
#23 ';'
#24 OBJECTID self
#24 ';'
#25 '}'
#26 '}'
#26 ';'
#29 OBJECTID getItem
#29 '('
#29 ')'
#29 ':'
#29 TYPEID Object
#29 '{'
#30 OBJECTID item
#31 '}'
#31 ';'
#34 OBJECTID getNext
#34 '('
#34 ')'
#34 ':'
#34 TYPEID StackNode
#34 '{'
#35 OBJECTID next
#36 '}'
#36 ';'
#37 '}'
#37 ';'
#45 CLASS
#45 TYPEID Stack
#45 INHERITS
#45 TYPEID IO
#45 '{'
#46 OBJECTID top
#46 ':'
#46 TYPEID StackNode
#46 ';'
#50 OBJECTID isEmpty
#50 '('
#50 ')'
#50 ':'
#50 TYPEID Bool
#50 '{'
#51 ISVOID
#51 OBJECTID top
#52 '}'
#52 ';'
#56 OBJECTID push
#56 '('
#56 OBJECTID item
#56 ':'
#56 TYPEID Object
#56 ')'
#56 ':'
#56 TYPEID SELF_TYPE
#56 '{'
#57 '{'
#58 LET
#58 OBJECTID new_node
#58 ':'
#58 TYPEID StackNode
#58 ASSIGN
#58 '('
#58 NEW
#58 TYPEID StackNode
#58 ')'
#58 '.'
#58 OBJECTID init
#58 '('
#58 OBJECTID item
#58 ','
#58 OBJECTID top
#58 ')'
#58 IN
#59 OBJECTID top
#59 ASSIGN
#59 OBJECTID new_node
#59 ';'
#60 OBJECTID self
#60 ';'
#61 '}'
#62 '}'
#62 ';'
#66 OBJECTID peek
#66 '('
#66 ')'
#66 ':'
#66 TYPEID Object
#66 '{'
#67 IF
#67 OBJECTID isEmpty
#67 '('
#67 ')'
#67 THEN
#68 '{'
#69 OBJECTID out_string
#69 '('
#69 STR_CONST "Error: peek from an empty stack.\n"
#69 ')'
#69 ';'
#70 OBJECTID abort
#70 '('
#70 ')'
#70 ';'
#71 NEW
#71 TYPEID Object
#71 ';'
#72 '}'
#73 ELSE
#74 OBJECTID top
#74 '.'
#74 OBJECTID getItem
#74 '('
#74 ')'
#75 FI
#76 '}'
#76 ';'
#80 OBJECTID pop
#80 '('
#80 ')'
#80 ':'
#80 TYPEID Object
#80 '{'
#81 IF
#81 OBJECTID isEmpty
#81 '('
#81 ')'
#81 THEN
#82 '{'
#83 OBJECTID out_string
#83 '('
#83 STR_CONST "Error: pop from an empty stack.\n"
#83 ')'
#83 ';'
#84 OBJECTID abort
#84 '('
#84 ')'
#84 ';'
#85 NEW
#85 TYPEID Object
#85 ';'
#86 '}'
#87 ELSE
#88 LET
#88 OBJECTID item_to_return
#88 ':'
#88 TYPEID Object
#88 ASSIGN
#88 OBJECTID top
#88 '.'
#88 OBJECTID getItem
#88 '('
#88 ')'
#88 IN
#89 '{'
#90 OBJECTID top
#90 ASSIGN
#90 OBJECTID top
#90 '.'
#90 OBJECTID getNext
#90 '('
#90 ')'
#90 ';'
#91 OBJECTID item_to_return
#91 ';'
#92 '}'
#93 FI
#94 '}'
#94 ';'
#98 OBJECTID print
#98 '('
#98 ')'
#98 ':'
#98 TYPEID SELF_TYPE
#98 '{'
#99 '{'
#100 IF
#100 OBJECTID isEmpty
#100 '('
#100 ')'
#100 THEN
#101 OBJECTID out_string
#101 '('
#101 STR_CONST "Stack is empty.\n"
#101 ')'
#102 ELSE
#103 '{'
#104 OBJECTID out_string
#104 '('
#104 STR_CONST "---- Top of Stack ----\n"
#104 ')'
#104 ';'
#105 LET
#105 OBJECTID current
#105 ':'
#105 TYPEID StackNode
#105 ASSIGN
#105 OBJECTID top
#105 IN
#107 WHILE
#107 NOT
#107 '('
#107 ISVOID
#107 OBJECTID current
#107 ')'
#107 LOOP
#108 '{'
#110 CASE
#110 OBJECTID current
#110 '.'
#110 OBJECTID getItem
#110 '('
#110 ')'
#110 OF
#111 OBJECTID s
#111 ':'
#111 TYPEID String
#111 DARROW
#111 '{'
#111 OBJECTID out_string
#111 '('
#111 OBJECTID s
#111 ')'
#111 ';'
#111 OBJECTID out_string
#111 '('
#111 STR_CONST "\n"
#111 ')'
#111 ';'
#111 '}'
#111 ';'
#112 OBJECTID i
#112 ':'
#112 TYPEID Int
#112 DARROW
#112 '{'
#112 OBJECTID out_int
#112 '('
#112 OBJECTID i
#112 ')'
#112 ';'
#112 OBJECTID out_string
#112 '('
#112 STR_CONST "\n"
#112 ')'
#112 ';'
#112 '}'
#112 ';'
#113 OBJECTID o
#113 ':'
#113 TYPEID Object
#113 DARROW
#113 OBJECTID out_string
#113 '('
#113 STR_CONST "Unprintable Object\n"
#113 ')'
#113 ';'
#114 ESAC
#114 ';'
#115 OBJECTID current
#115 ASSIGN
#115 OBJECTID current
#115 '.'
#115 OBJECTID getNext
#115 '('
#115 ')'
#115 ';'
#116 '}'
#117 POOL
#117 ';'
#118 OBJECTID out_string
#118 '('
#118 STR_CONST "---- Bottom of Stack ----\n"
#118 ')'
#118 ';'
#119 '}'
#120 FI
#120 ';'
#121 OBJECTID self
#121 ';'
#122 '}'
#123 '}'
#123 ';'
#124 '}'
#124 ';'
#131 CLASS
#131 TYPEID Main
#131 INHERITS
#131 TYPEID IO
#131 '{'
#132 OBJECTID main
#132 '('
#132 ')'
#132 ':'
#132 TYPEID Object
#132 '{'
#133 LET
#133 OBJECTID my_stack
#133 ':'
#133 TYPEID Stack
#133 ASSIGN
#133 NEW
#133 TYPEID Stack
#133 IN
#134 '{'
#135 OBJECTID out_string
#135 '('
#135 STR_CONST "--- Stack Demo ---\n\n"
#135 ')'
#135 ';'
#138 OBJECTID out_string
#138 '('
#138 STR_CONST "Is stack empty? "
#138 ')'
#138 ';'
#139 IF
#139 OBJECTID my_stack
#139 '.'
#139 OBJECTID isEmpty
#139 '('
#139 ')'
#139 THEN
#139 OBJECTID out_string
#139 '('
#139 STR_CONST "Yes\n"
#139 ')'
#139 ELSE
#139 OBJECTID out_string
#139 '('
#139 STR_CONST "No\n"
#139 ')'
#139 FI
#139 ';'
#140 OBJECTID my_stack
#140 '.'
#140 OBJECTID print
#140 '('
#140 ')'
#140 ';'
#141 OBJECTID out_string
#141 '('
#141 STR_CONST "\n"
#141 ')'
#141 ';'
#144 OBJECTID out_string
#144 '('
#144 STR_CONST "Pushing 'Alice', 100, 'Bob'...\n"
#144 ')'
#144 ';'
#145 OBJECTID my_stack
#145 '.'
#145 OBJECTID push
#145 '('
#145 STR_CONST "Alice"
#145 ')'
#145 ';'
#146 OBJECTID my_stack
#146 '.'
#146 OBJECTID push
#146 '('
#146 INT_CONST 100
#146 ')'
#146 ';'
#147 OBJECTID my_stack
#147 '.'
#147 OBJECTID push
#147 '('
#147 STR_CONST "Bob"
#147 ')'
#147 ';'
#148 OBJECTID my_stack
#148 '.'
#148 OBJECTID print
#148 '('
#148 ')'
#148 ';'
#149 OBJECTID out_string
#149 '('
#149 STR_CONST "\n"
#149 ')'
#149 ';'
#152 OBJECTID out_string
#152 '('
#152 STR_CONST "Peeking top element: "
#152 ')'
#152 ';'
#153 CASE
#153 OBJECTID my_stack
#153 '.'
#153 OBJECTID peek
#153 '('
#153 ')'
#153 OF
#154 OBJECTID s
#154 ':'
#154 TYPEID String
#154 DARROW
#154 OBJECTID out_string
#154 '('
#154 OBJECTID s
#154 ')'
#154 ';'
#155 OBJECTID i
#155 ':'
#155 TYPEID Int
#155 DARROW
#155 OBJECTID out_int
#155 '('
#155 OBJECTID i
#155 ')'
#155 ';'
#156 OBJECTID o
#156 ':'
#156 TYPEID Object
#156 DARROW
#156 OBJECTID out_string
#156 '('
#156 STR_CONST "Object"
#156 ')'
#156 ';'
#157 ESAC
#157 ';'
#158 OBJECTID out_string
#158 '('
#158 STR_CONST "\n\n"
#158 ')'
#158 ';'
#161 OBJECTID out_string
#161 '('
#161 STR_CONST "Popping an element...\n"
#161 ')'
#161 ';'
#162 OBJECTID my_stack
#162 '.'
#162 OBJECTID pop
#162 '('
#162 ')'
#162 ';'
#163 OBJECTID my_stack
#163 '.'
#163 OBJECTID print
#163 '('
#163 ')'
#163 ';'
#164 OBJECTID out_string
#164 '('
#164 STR_CONST "\n"
#164 ')'
#164 ';'
#167 OBJECTID out_string
#167 '('
#167 STR_CONST "Is stack empty? "
#167 ')'
#167 ';'
#168 IF
#168 OBJECTID my_stack
#168 '.'
#168 OBJECTID isEmpty
#168 '('
#168 ')'
#168 THEN
#168 OBJECTID out_string
#168 '('
#168 STR_CONST "Yes\n"
#168 ')'
#168 ELSE
#168 OBJECTID out_string
#168 '('
#168 STR_CONST "No\n"
#168 ')'
#168 FI
#168 ';'
#169 OBJECTID out_string
#169 '('
#169 STR_CONST "\n"
#169 ')'
#169 ';'
#172 OBJECTID out_string
#172 '('
#172 STR_CONST "Popping all elements...\n"
#172 ')'
#172 ';'
#173 OBJECTID my_stack
#173 '.'
#173 OBJECTID pop
#173 '('
#173 ')'
#173 ';'
#174 OBJECTID my_stack
#174 '.'
#174 OBJECTID pop
#174 '('
#174 ')'
#174 ';'
#175 OBJECTID my_stack
#175 '.'
#175 OBJECTID print
#175 '('
#175 ')'
#175 ';'
#176 OBJECTID out_string
#176 '('
#176 STR_CONST "\n"
#176 ')'
#176 ';'
#179 OBJECTID out_string
#179 '('
#179 STR_CONST "Now trying to pop from an empty stack...\n"
#179 ')'
#179 ';'
#180 OBJECTID my_stack
#180 '.'
#180 OBJECTID pop
#180 '('
#180 ')'
#180 ';'
#181 OBJECTID out_string
#181 '('
#181 STR_CONST "This line will not be reached.\n"
#181 ')'
#181 ';'
#182 '}'
#183 '}'
#183 ';'
#184 '}'
#184 ';'
